document.addEventListener("DOMContentLoaded", function() {
    function loadScreen(screen) {
        fetch(screen)
            .then(response => response.text())
            .then(html => {
                document.getElementById('content').innerHTML = html;
                const scripts = document.querySelectorAll('#content script');
                scripts.forEach(oldScript => {
                    const newScript = document.createElement('script');
                    newScript.innerHTML = oldScript.innerHTML;
                    document.body.appendChild(newScript);
                });
                setupEventListeners(); // Set up event listeners after loading new content
            })
            .catch(error => {
                console.error('Ошибка загрузки экрана:', error);
            });
    }

    // Load the login screen by default
    loadScreen('login/login.html');

    // Attach event listeners to navigation links
    document.getElementById('authLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('login/login.html');
    });

    document.getElementById('calculateLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('calculate/calculate.html');
    });

    document.getElementById('recipientLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('recipient/recipient.html');
    });

    document.getElementById('senderLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('sender/sender.html');
    });

    document.getElementById('deliveryLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('delivery/delivery.html');
    });

    document.getElementById('profileLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('profile/profile.html');
    });

    document.getElementById('courierLink').addEventListener('click', function(event) {
        event.preventDefault();
        loadScreen('courier/courier.html');
    });

    // Set up event listeners after loading new content
    function setupEventListeners() {
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', function(event) {
                event.preventDefault();
                const phone = document.getElementById('phone').value;
                const code = document.getElementById('code').value;
                if (phone && code) {
                    document.getElementById('loginMessage').textContent = 'Вход выполнен успешно';
                    loadScreen('calculate/calculate.html');
                } else {
                    document.getElementById('loginMessage').textContent = 'Введите телефон и код';
                }
            });
        }
    }

    // Make loadScreen function available globally
    window.loadScreen = loadScreen;
});

